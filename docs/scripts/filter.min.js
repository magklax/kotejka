"use strict";(()=>{const e=window.data.roomArr,t=window.render.createRoomCards;let i=e;const r=document.querySelector(".overlay"),s=document.querySelector(".rooms__index"),n=document.querySelector("#filters-open"),c=document.querySelector("#filters-form"),o=c.querySelector("#filters-close"),d=c.querySelector("#filters-submit"),l=c.querySelector("#filters-reset"),a=c.querySelector("#min-price"),u=c.querySelector("#max-price"),v=c.querySelector("#squareFieldset"),w=c.querySelector("#facilityFieldset"),m=document.querySelector("#sorting-open"),y=document.querySelector("#sorting-list"),E=(y.querySelectorAll(".sorting__item"),e=>{for(;s.firstChild;)s.removeChild(s.firstChild);t(e)}),q=e=>{var t=[];return e.querySelectorAll(":checked").forEach(e=>{t.push(e.value)}),t},f=function(){this.minPrice=this.setMinPrice(a.value),this.maxPrice=this.setMaxPrice(u.value),this.square=this.getSquare(),this.facilities=this.getFacilities()};f.prototype={setMinPrice:e=>e||100,setMaxPrice:e=>e||600,getSquare:()=>q(v),getFacilities:()=>q(w)},c.addEventListener("change",t=>{t.preventDefault();const r=new f;i=e.filter(e=>{let t=!0;return(r.minPrice>e.price||r.maxPrice<e.price)&&(t=!1),r.square.length>0&&(r.square.includes(e.square)||(t=!1)),r.facilities.length>0&&r.facilities.forEach(i=>{e.facilities.includes(i)||(t=!1)}),t}),E(i)});const h=e=>i.sort((t,i)=>t[e]-i[e]),L=e=>i.sort((t,i)=>i[e]-t[e]),k=e=>{window.utils.isEscKeycode(e,S)},p=()=>{r.classList.add("active"),window.utils.showElement(c),document.addEventListener("keydown",k)},S=()=>{r.classList.remove("active"),window.utils.hideElement(c),document.removeEventListener("keydown",k)},g=()=>{E(e)},x=e=>{e.preventDefault(),S()},P=e=>{e.preventDefault(),window.utils.isEnterKeycode(e,S)};l.addEventListener("click",e=>{g()}),l.addEventListener("click",e=>{window.utils.isEnterKeycode(e,g)}),n.addEventListener("click",e=>{e.preventDefault(),p()}),n.addEventListener("keydown",e=>{e.preventDefault(),window.utils.isEnterKeycode(e,p)}),o.addEventListener("click",x),o.addEventListener("keydown",P),d.addEventListener("click",x),d.addEventListener("keydown",P);const C=()=>{window.utils.hideElement(y),m.classList.remove("active"),m.addEventListener("click",b)},D=e=>{window.utils.isEscKeycode(e,C)},K=e=>{e.target!==m&&(C(),document.removeEventListener("click",K,!0))},b=e=>{m.classList.contains("active")?C():(window.utils.showElement(y),m.classList.add("active"),document.addEventListener("keydown",D),document.addEventListener("click",K,!0))};m.addEventListener("click",b),y.addEventListener("click",e=>{(e=>{switch(e){case"square-up":i=h("square");break;case"square-down":i=L("square");break;case"price-up":i=h("price");break;case"price-down":i=L("price")}E(i)})(e.target.id),m.textContent=e.target.textContent})})();